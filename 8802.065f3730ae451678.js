"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8802],{28802:(Z,v,c)=>{c.r(v),c.d(v,{LoginPageModule:()=>M});var y=c(36895),u=c(24006),m=c(90603),f=c(93165),_=c(15861),I=c(88075),t=c(94650),P=c(80529),C=c(98420),L=c(11716),D=c(38264),T=c(59348),b=c(39219),A=c(34221);function w(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"input",22),t.NdJ("ngModelChange",function(o){t.CHM(i);const n=t.oxw();return t.KtG(n.password=o)}),t.qZA()}if(2&a){const i=t.oxw();t.s9C("placeholder",i.login.password),t.Q6J("ngModel",i.password)}}function F(a,d){if(1&a){const i=t.EpF();t.TgZ(0,"input",6),t.NdJ("ngModelChange",function(o){t.CHM(i);const n=t.oxw();return t.KtG(n.password=o)}),t.qZA()}if(2&a){const i=t.oxw();t.s9C("placeholder",i.login.password),t.Q6J("ngModel",i.password)}}function N(a,d){1&a&&t._UZ(0,"ion-icon",23)}function E(a,d){1&a&&t._UZ(0,"ion-icon",24)}const U=[{path:"",component:(()=>{class a extends I.P{constructor(i,e,o,n,r,h,l,s,g,p,k,O,S){super(),this.navCtrl=i,this.loadingCtrl=e,this.menu=o,this.toastCtrl=n,this.http=r,this.router=h,this.dbProvider=l,this.events=s,this.platform=g,this.TokenService=p,this.Encrypt=k,this.homeMessage=O,this.Auth=S,this.showPassword=!1,this.login={user_name:"User Name",password:"Password",forgot_password:"Forgot Password",login:"login",no_account_text:"Don't have an account?",signup_text:"Sign up",Customer_code:"Customer Code"},this.Dbcode="",this.english="Eng",this.Hindi="\u0939\u093f\u0902\u0926\u0940",this.Tamil="\u0ba4\u0bae\u0bbf\u0bb4\u0bcd",this.email="",this.password="",this.password_type="password",this.showPass=!1,this.OrightPreferences=[],this.DairyFarmConfiguration=[],this.dairyLogoPathForCoobranding=[],this.getData(),this.platform.ready().then(()=>{this.platform.backButton.subscribeWithPriority(9999,()=>{})})}ngOnInit(){this.menu.get().then(i=>{i.swipeGesture=!1})}getData(){var i=this.getItem(this.LANG_SELECTED);this.http.get("assets/lang/"+i+".json").subscribe(o=>{try{let n=JSON.parse(JSON.stringify(o));this.login=n.login}catch(n){this.presentToast(this.toastCtrl,"Invalid Credentials"),console.error(n)}},o=>{})}goTotest(){this.router.navigate(["/test"])}getData1(i){let e="";"hn"==i?(this.saveItem(this.LANG_SELECTED,"hn"),this.homeMessage.sendMessage("Hindi_language"),e="assets/lang/hn.json"):"en"==i?(this.saveItem(this.LANG_SELECTED,"en"),this.homeMessage.sendMessage("English_language"),e="assets/lang/en.json"):"tm"==i&&(this.saveItem(this.LANG_SELECTED,"tm"),this.homeMessage.sendMessage("Tamil_language"),e="assets/lang/tm.json"),this.http.get(e).subscribe(o=>{try{let n=JSON.parse(JSON.stringify(o));this.login=n.login}catch(n){this.presentToast(this.toastCtrl,"Invalid Credentials"),console.error(n)}},o=>{})}initPage(){this.saveItem(this.DEFAULT_LOCALE,this.ENGLISH_LOCALE),this.getItem(this.DEFAULT_LOCALE)==this.HINDI_LOCALE||this.getItem(this.DEFAULT_LOCALE)}openHomePage(){this.navCtrl.navigateRoot("/home").then(i=>{}),this.saveItem("rootPage","/home")}changeCustomerCode(i){this.saveItem("Db_code","null"),this.saveItem("Db_code",i.trim())}callLoginAPI(i){var e=this;return(0,_.Z)(function*(){if(e.saveItem("Db_code","null"),e.saveItem("Db_code",i.trim()),""!=e.email||""!=e.password){let o=yield e.loadingComp(e.loadingCtrl);o.present();let n=e.BASE_URL+"api/servicesAPI/validateuser_mob?UserName="+e.email+"&pword="+e.password+"&Key="+e.key+"&con="+e.Dbcode,h=(e.Encrypt.EncryptTextWithPublicKey(e.password,e.AesSecretIVKey),new FormData);e.http.post(n,h).subscribe(function(){var l=(0,_.Z)(function*(s){console.log(s,"result");try{var g=JSON.parse(JSON.stringify(s));0!=g[0].UserId?(e.saveItem(e.LOGIN_USER_DATA,JSON.stringify(s)),e.saveItem(e.IS_LOGIN,"1"),e.saveItem("Db_code",e.Dbcode.trim()),e.TokenService.setToken(s[0].token),e.TokenService.setRefreshAccessToken(s[0].refreshToken),e.TokenService.setAuthToken(s[0].refreshAccessToken),e.sendDeviceToken(g[0].UserId),yield e.callOrightPrefernceApi(g[0]),yield e.callDairyFarmConfigurationApi(g[0].UserId),yield e.callDairyLogoPathForCoobrandingApi(g[0].Farm_ID),o.dismiss(),yield e.GetServices(g,g[0].UserId),e.dbProvider.createAndInsertUserTable(),e.getUserNotifications(),e.Auth.startPasswordCheckService(!0),e.events.publish("login_done","")):(o.dismiss(),e.presentToast(e.toastCtrl,"Invalid login credentials"))}catch{o.dismiss(),e.presentToast(e.toastCtrl,"Invalid Credentials")}});return function(s){return l.apply(this,arguments)}}(),l=>{o.dismiss(),console.error("API Error",l),e.somethingWentWrongError(e.toastCtrl)})}else e.presentToast(e.toastCtrl,"Please enter fields properly"),e.saveItem("Db_code","")})()}getUserNotifications(){let i=0;this.dbProvider.getAllNotificationRecords(this.getFarmerUserID()).then(e=>{if(0==e.rows.length)this.callNotificationsApi(i);else for(let o=0;o<e.rows.length;o++)i<e.rows.item(o).ID&&(i=e.rows.item(o).ID),o==e.rows.length-1&&this.callNotificationsApi(i)},e=>{console.error("getNotificationList error: ",e)})}callNotificationsApi(i){let e=this.BASE_URL+"api/servicesAPI/getAllUserNotifications?userid="+this.getFarmerUserID()+"&lastrecod_id="+i+"&Key="+this.key+"&con="+this.Dbcode;this.http.get(e).subscribe(o=>{try{var n=JSON.parse(JSON.stringify(o));if(n.length>0)for(let r=0;r<n.length;r++)if(0!=n[r].Notifications_id){const h={Notifications_id:n[r].Notifications_id,Notification_Title:n[r].Notification_Title,Notification_Body:n[r].Notification_Body,Notification_Data:n[r].Notification_Data,Notification_Date:n[r].Notification_Date,Notification_Seen:n[r].Notification_Seen};this.dbProvider.createAndInsertNotificationTable(h.Notifications_id,this.getFarmerUserID(),h.Notification_Title,h.Notification_Body,h.Notification_Data,h.Notification_Seen,h.Notification_Date)}}catch(r){console.error(r)}},o=>{console.error("API Error",o)})}forgotPassword(){this.router.navigate(["/forgot-password"])}showHide(){this.showPass=!this.showPass,this.password_type=this.showPass?"text":"password"}signup(){this.router.navigate(["/customer-registration"])}getCountryList(){let e=new FormData;e.append("device_token",""),e.append("device_name","Mi Note 7 Pro"),e.append("device_os","android"),e.append("language","en"),e.append("location_lant","234.3343434"),e.append("location_long","234.3343434"),e.append("login_type","1"),this.http.post("https://digiversal.info/api/v1/settings/allCountries",e).subscribe(o=>{},o=>{console.error("API Error",o),this.somethingWentWrongError(this.toastCtrl)})}sendDeviceToken(i){try{var e=this.getItem("device_token");let r=this.getItem("AppVersion");var o=[];o.push({DeviceToken:e,User_ID:i,Version:r});var n=this.BASE_URL+"api/FirebasePushNotificationApi/InsertDeviceToken?FirebaseDeviceModel="+JSON.stringify(o)+"&Key="+this.key+"&con="+this.Dbcode;let h=new FormData;this.http.post(n,h).subscribe(l=>{},l=>{console.error("Device token api error ",l)})}catch(r){console.error("error function sendDeviceToken LoginPage:-",r)}}GetServices(i,e){return new Promise((o,n)=>{try{this.saveItem("Services","[]");var r=this.BASE_URL+"api/dashboardAPI/GetServices?UID="+JSON.stringify([{UesrID:e}])+"&Key="+this.key+"&con="+this.Dbcode;this.http.get(r).subscribe(l=>{try{this.saveItem("Services",JSON.stringify(l)),"1"==i[0].userType?(this.saveItem(this.IS_LOGIN,"1"),this.saveItem("menuOption",""),this.navCtrl.navigateRoot("/farmer-dashboard"),this.saveItem("rootPage","/farmer-dashboard")):"2"==i[0].userType?(this.saveItem(this.IS_LOGIN,"1"),"19"==i[0].Farm_ID.toString()?(this.saveItem("menuOption",""),this.navCtrl.navigateRoot("/dairy-farm-dbrd-no-amount-no-milktype"),this.saveItem("rootPage","/dairy-farm-dbrd-no-amount-no-milktype")):(this.saveItem("menuOption",""),this.navCtrl.navigateRoot("/dairy-farm-dashboard"),this.saveItem("rootPage","/dairy-farm-dashboard"))):"3"==i[0].userType?(this.saveItem(this.IS_LOGIN,"1"),"19"==i[0].Farm_ID.toString()?(this.saveItem("menuOption",""),this.navCtrl.navigateRoot("/collector-dbrd-no-amount-no-milktype"),this.saveItem("rootPage","/collector-dbrd-no-amount-no-milktype")):i[0].Farm_ID.toString()==this.GFO_FARMID?(this.saveItem("menuOption",""),this.saveItem("rootPage","/collector2"),this.navCtrl.navigateRoot("/collector2")):(this.saveItem("menuOption",""),this.saveItem("rootPage","/collector"),this.navCtrl.navigateRoot("/collector"))):"4"==i[0].userType?(this.saveItem(this.IS_LOGIN,"1"),this.saveItem("menuOption",""),this.navCtrl.navigateRoot("/customer-qr-scan"),this.saveItem("rootPage","/customer-qr-scan")):"5"==i[0].userType?(this.saveItem(this.IS_LOGIN,"1"),this.saveItem("menuOption",""),this.navCtrl.navigateRoot("/delivery-boy-scan-bottle"),this.saveItem("rootPage","/delivery-boy-scan-bottle")):"6"==i[0].userType?(this.saveItem(this.IS_LOGIN,"1"),this.saveItem("menuOption",""),this.saveItem("rootPage","/delivery-van"),this.navCtrl.navigateRoot("/delivery-van")):"7"==i[0].userType?(this.saveItem(this.IS_LOGIN,"1"),this.saveItem("menuOption",""),this.navCtrl.navigateRoot("/chilling-centre-dashboard"),this.saveItem("rootPage","/chilling-centre-dashboard")):"8"==i[0].userType?(this.saveItem(this.IS_LOGIN,"1"),this.saveItem("menuOption",""),this.navCtrl.navigateRoot("/oright-dashboard"),this.saveItem("rootPage","/oright-dashboard")):"9"==i[0].userType?(this.saveItem(this.IS_LOGIN,"1"),this.saveItem("menuOption",""),this.navCtrl.navigateRoot("/delivery-van-outbound-dashboard"),this.saveItem("rootPage","/delivery-van-outbound-dashboard")):"10"==i[0].userType&&(this.saveItem(this.IS_LOGIN,"1"),this.saveItem("menuOption",""),this.navCtrl.navigateRoot("/inbound-transporter-dashboard"),this.saveItem("rootPage","/inbound-transporter-dashboard"))}catch(s){console.error(s)}},l=>{console.error("API Error",l)}),o()}catch(h){console.error("error function GetServices LoginPage:-",h)}})}callOrightPrefernceApi(i){return new Promise((e,o)=>{try{var n="0";"3"==i.userType?n=i.CollectionCentre_ID:"7"==i.userType?n=i.ChillingCentre_ID:"2"==i.userType&&(n=i.Farm_ID);let h=this.BASE_URL+"api/servicesAPI/getOrightPreferences?getOrightPreferences="+JSON.stringify([{Organization_id:n,Usertype_id:i.userType,ParameterKey:"0"}])+"&Key="+this.key+"&con="+this.Dbcode;this.http.get(h).subscribe(l=>{try{var s=JSON.parse(JSON.stringify(l));if(s.length>0){for(let g=0;g<s.length;g++)this.OrightPreferences.push({Organization_id:s[g].Organization_id,OrightPreference_id:s[g].OrightPreference_id,ParameterKey:s[g].ParameterKey,ParameterValue:s[g].ParameterValue,Usertype_id:s[g].Usertype_id,UserEditableStatus:s[g].UserEditableStatus,IsBoolean:s[g].IsBoolean,ShowToUserStatus:s[g].ShowToUserStatus,ParameterName:s[g].ParameterName});this.saveItem("OrightPreferences",JSON.stringify(this.OrightPreferences))}else this.saveItem("OrightPreferences",JSON.stringify(this.OrightPreferences))}catch(g){console.error(g)}},l=>{console.error("API Error",l)}),e()}catch(r){console.error("error function callOrightPrefernceApi LoginPage",r)}})}callDairyFarmConfigurationApi(i){return new Promise((e,o)=>{try{var n=this.BASE_URL+"api/DairyFarmApi/getAllDairyFarmConfiguration?UserId="+i+"&Key="+this.key+"&con="+this.Dbcode;new FormData,this.http.get(n).subscribe(h=>{try{var l=JSON.parse(JSON.stringify(h));if(l.length>0){for(let s=0;s<l.length;s++)this.DairyFarmConfiguration.push({UserId:l[s].UserId,FarmConfiguration_ID:l[s].FarmConfiguration_ID,Farm_Name:l[s].Farm_Name,Parameter:l[s].Parameter,Value:l[s].Value});this.saveItem("DairyFarmConfiguration",JSON.stringify(this.DairyFarmConfiguration))}else this.saveItem("DairyFarmConfiguration",JSON.stringify(this.DairyFarmConfiguration))}catch(s){console.error(s)}}),e()}catch(r){console.error("error function callDairyFarmConfigurationApi LoginPage:- ",r)}})}callDairyLogoPathForCoobrandingApi(i){return new Promise((e,o)=>{try{var n=this.BASE_URL+"api/DairyFarmApi/getDairyLogoPathForCoobranding?DairyID="+i+"&Key="+this.key+"&con="+this.Dbcode;new FormData,this.http.get(n).subscribe(h=>{try{var l=JSON.parse(JSON.stringify(h));l.length>0&&"0"!=l[0].DairyFarm_Id&&"null"!=l[0].Farm_Logo_Path?(this.dairyLogoPathForCoobranding=l,this.saveItem("Farm_Logo",JSON.stringify(this.dairyLogoPathForCoobranding[0].Farm_Logo_base64)),this.saveItem("Farm_Logo_Path",JSON.stringify(this.dairyLogoPathForCoobranding[0].Farm_Logo_Path))):(this.saveItem("Farm_Logo_Path","null"),this.saveItem("Farm_Logo","null"))}catch(s){console.error(s)}}),e()}catch(r){console.error("error function callDairyLogoPathForCoobrandingApi LoginPage:-",r)}})}ionViewDidEnter(){this.menu.get().then(i=>{i.swipeGesture=!1})}ionViewWillEnter(){this.initPage()}ionViewWillLeave(){this.menu.get().then(i=>{i.swipeGesture=!0})}}return a.\u0275fac=function(i){return new(i||a)(t.Y36(m.SH),t.Y36(m.HT),t.Y36(m._q),t.Y36(m.yF),t.Y36(P.eN),t.Y36(f.F0),t.Y36(C.a),t.Y36(L.n),t.Y36(m.t4),t.Y36(D.B),t.Y36(T.C),t.Y36(b.y),t.Y36(A.s))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-login"]],features:[t.qOj],decls:33,vars:13,consts:[[2,"height","100%","display","flex","text-align","center","align-items","center","justify-content","center"],[1,"web-container","login-form__container"],[2,"width","50%","margin","0 auto","min-width","300px","max-width","330px"],["src","assets/imgs/logo.png",2,"width","100%","height","auto"],[1,"login-form__inputsAndButtons"],[2,"padding","0px","margin","20px 0"],["type","text",1,"login_input",3,"placeholder","ngModel","ngModelChange"],[2,"padding","0px","margin","20px 0","display","flex","align-items","center"],["class","login_input","type","password",3,"placeholder","ngModel","ngModelChange",4,"ngIf"],["class","login_input","type","text",3,"placeholder","ngModel","ngModelChange",4,"ngIf"],["tabindex","-1","ion-button","","item-right","",1,"login_form__showPasswordBtn",2,"margin-left","-50px",3,"click"],["name","eye",4,"ngIf"],["name","eye-off",4,"ngIf"],["type","text",1,"login_input",3,"placeholder","ngModel","change","ngModelChange"],[2,"text-align","center","margin-top","10px","padding","0px",3,"click"],[2,"font-family","nexa_bold","color","#666666"],[2,"width","100%","display","flex","text-align","center","justify-content","center","align-items","center","padding","0px"],[2,"background-color","#88dd4b","width","98%","display","flex","text-align","center","justify-content","center","align-items","center","border-radius","25px","height","52px","font-size","15px","font-weight","bolder","color","#ffffff","font-family","nexa_bold",3,"click"],[2,"padding","0px"],[2,"display","flex","flex-wrap","no-wrap","text-align","center","align-items","center","justify-content","center","color","#666666"],[2,"font-family","nexa_bold",3,"click"],[2,"margin-left","5px"],["type","password",1,"login_input",3,"placeholder","ngModel","ngModelChange"],["name","eye"],["name","eye-off"]],template:function(i,e){1&i&&(t.TgZ(0,"ion-content")(1,"div",0)(2,"div",1)(3,"div",2),t._UZ(4,"img",3),t.qZA(),t.TgZ(5,"div",4)(6,"div",5)(7,"input",6),t.NdJ("ngModelChange",function(n){return e.email=n}),t.qZA()(),t.TgZ(8,"div",7),t.YNc(9,w,1,2,"input",8),t.YNc(10,F,1,2,"input",9),t.TgZ(11,"button",10),t.NdJ("click",function(){return e.showPasswordText=!e.showPasswordText}),t.YNc(12,N,1,0,"ion-icon",11),t.YNc(13,E,1,0,"ion-icon",12),t.qZA()(),t.TgZ(14,"div",5)(15,"input",13),t.NdJ("change",function(){return e.changeCustomerCode(e.Dbcode)})("ngModelChange",function(n){return e.Dbcode=n}),t.qZA()(),t.TgZ(16,"div",14),t.NdJ("click",function(){return e.forgotPassword()}),t.TgZ(17,"p",15),t._uU(18),t.qZA()(),t.TgZ(19,"div",16)(20,"button",17),t.NdJ("click",function(){return e.callLoginAPI(e.Dbcode)}),t._uU(21),t.qZA()(),t.TgZ(22,"div",18)(23,"div",19)(24,"p",20),t.NdJ("click",function(){return e.getData1("en")}),t.TgZ(25,"u",21),t._uU(26),t.qZA()(),t.TgZ(27,"p",20),t.NdJ("click",function(){return e.getData1("hn")}),t.TgZ(28,"u",21),t._uU(29),t.qZA()(),t.TgZ(30,"p",20),t.NdJ("click",function(){return e.getData1("tm")}),t.TgZ(31,"u",21),t._uU(32),t.qZA()()()()()()()()),2&i&&(t.xp6(7),t.s9C("placeholder",e.login.user_name),t.Q6J("ngModel",e.email),t.xp6(2),t.Q6J("ngIf",!e.showPasswordText),t.xp6(1),t.Q6J("ngIf",e.showPasswordText),t.xp6(2),t.Q6J("ngIf",e.showPasswordText),t.xp6(1),t.Q6J("ngIf",!e.showPasswordText),t.xp6(2),t.s9C("placeholder",e.login.Customer_code),t.Q6J("ngModel",e.Dbcode),t.xp6(3),t.hij(" ",e.login.forgot_password," "),t.xp6(3),t.hij(" ",e.login.login," "),t.xp6(5),t.Oqu(e.english),t.xp6(3),t.Oqu(e.Hindi),t.xp6(3),t.Oqu(e.Tamil))},dependencies:[y.O5,u.Fj,u.JJ,u.On,m.W2,m.gu]}),a})()}];let x=(()=>{class a{}return a.\u0275fac=function(i){return new(i||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[f.Bz.forChild(U),f.Bz]}),a})(),M=(()=>{class a{}return a.\u0275fac=function(i){return new(i||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[y.ez,u.u5,m.Pc,x]}),a})()}}]);